#include <stdio.h>
#include <string.h>

// ==========================
// Função auxiliar: imprime menu do atributo (com opção bloqueada)
// ==========================
void mostrarMenuAtributos(int bloqueado) {
    printf("\nEscolha um atributo numerico para comparar:\n");

    if (bloqueado != 1) printf("1 - Populacao\n");
    if (bloqueado != 2) printf("2 - Area\n");
    if (bloqueado != 3) printf("3 - PIB\n");
    if (bloqueado != 4) printf("4 - Pontos turisticos\n");
    if (bloqueado != 5) printf("5 - Densidade Demografica (MENOR vence)\n");
    if (bloqueado != 6) printf("6 - PIB per capita\n");

    printf("Opcao: ");
}

// ==========================
// Função auxiliar: valida se opcao é válida e não é bloqueada
// ==========================
int opcaoValida(int opcao, int bloqueado) {
    if (opcao < 1 || opcao > 6) return 0;
    if (opcao == bloqueado) return 0;
    return 1;
}

// ==========================
// Função auxiliar: retorna o valor do atributo escolhido
// (usa switch)
// ==========================
float valorAtributo(
    int opcao,
    unsigned long int populacao,
    float area,
    float pib,
    int pontos,
    float densidade,
    float pibPerCapita
) {
    switch (opcao) {
        case 1: return (float)populacao;
        case 2: return area;
        case 3: return pib;
        case 4: return (float)pontos;
        case 5: return densidade;
        case 6: return pibPerCapita;
        default: return 0.0f;
    }
}

// ==========================
// Função auxiliar: nome do atributo
// ==========================
void nomeAtributo(int opcao, char *dest, int tam) {
    switch (opcao) {
        case 1: strncpy(dest, "Populacao", tam); break;
        case 2: strncpy(dest, "Area", tam); break;
        case 3: strncpy(dest, "PIB", tam); break;
        case 4: strncpy(dest, "Pontos turisticos", tam); break;
        case 5: strncpy(dest, "Densidade Demografica", tam); break;
        case 6: strncpy(dest, "PIB per capita", tam); break;
        default: strncpy(dest, "Invalido", tam); break;
    }
    dest[tam - 1] = '\0';
}

// ==========================
// Função auxiliar: decide vencedor de 1 atributo
// Retorna: 0 empate, 1 carta1 vence, 2 carta2 vence
// Regra: maior vence, exceto densidade (opcao 5) => menor vence
// Usa operador ternário
// ==========================
int vencedorPorAtributo(int opcao, float v1, float v2) {
    int densidade = (opcao == 5);

    // ternário para escolher a regra de comparação
    if (densidade) {
        return (v1 < v2) ? 1 : (v2 < v1) ? 2 : 0;
    } else {
        return (v1 > v2) ? 1 : (v2 > v1) ? 2 : 0;
    }
}

int main() {
    // ==========================
    // Cartas (pre-cadastradas)
    // Você pode trocar esses valores pelos do seu desafio anterior.
    // ==========================
    char nome1[60] = "Brasil";
    unsigned long int populacao1 = 203062512;
    float area1 = 8515767.0f;
    float pib1 = 1900.0f;
    int pontos1 = 25;

    char nome2[60] = "Canada";
    unsigned long int populacao2 = 40000000;
    float area2 = 9984670.0f;
    float pib2 = 2100.0f;
    int pontos2 = 18;

    // ==========================
    // Calculos
    // ==========================
    float densidade1 = (area1 > 0.0f) ? ((float)populacao1 / area1) : 0.0f;
    float pibPerCapita1 = (populacao1 > 0) ? (pib1 / (float)populacao1) : 0.0f;

    float densidade2 = (area2 > 0.0f) ? ((float)populacao2 / area2) : 0.0f;
    float pibPerCapita2 = (populacao2 > 0) ? (pib2 / (float)populacao2) : 0.0f;

    // ==========================
    // Escolha de 2 atributos (menus dinamicos)
    // ==========================
    int atributo1 = 0, atributo2 = 0;

    printf("=== SUPER TRUNFO - DESAFIO FINAL (2 atributos) ===\n");
    printf("Carta 1: %s\n", nome1);
    printf("Carta 2: %s\n", nome2);

    // Escolher atributo 1
    while (1) {
        mostrarMenuAtributos(0);
        if (scanf("%d", &atributo1) != 1) {
            printf("Entrada invalida. Encerrando.\n");
            return 0;
        }
        if (opcaoValida(atributo1, 0)) break;
        printf("Opcao invalida. Tente novamente.\n");
    }

    // Escolher atributo 2 (dinamico: bloqueia o atributo1)
    while (1) {
        printf("\nAgora escolha o SEGUNDO atributo (diferente do primeiro).\n");
        mostrarMenuAtributos(atributo1);
        if (scanf("%d", &atributo2) != 1) {
            printf("Entrada invalida. Encerrando.\n");
            return 0;
        }
        if (opcaoValida(atributo2, atributo1)) break;
        printf("Opcao invalida (ou repetida). Tente novamente.\n");
    }

    // ==========================
    // Pegar valores dos atributos escolhidos
    // ==========================
    float c1_a1 = valorAtributo(atributo1, populacao1, area1, pib1, pontos1, densidade1, pibPerCapita1);
    float c2_a1 = valorAtributo(atributo1, populacao2, area2, pib2, pontos2, densidade2, pibPerCapita2);

    float c1_a2 = valorAtributo(atributo2, populacao1, area1, pib1, pontos1, densidade1, pibPerCapita1);
    float c2_a2 = valorAtributo(atributo2, populacao2, area2, pib2, pontos2, densidade2, pibPerCapita2);

    // Nomes dos atributos
    char nomeAttr1[50], nomeAttr2[50];
    nomeAtributo(atributo1, nomeAttr1, sizeof(nomeAttr1));
    nomeAtributo(atributo2, nomeAttr2, sizeof(nomeAttr2));

    // ==========================
    // Comparacao individual
    // ==========================
    int win1 = vencedorPorAtributo(atributo1, c1_a1, c2_a1);
    int win2 = vencedorPorAtributo(atributo2, c1_a2, c2_a2);

    // ==========================
    // Soma dos atributos
    // ==========================
    float soma1 = c1_a1 + c1_a2;
    float soma2 = c2_a1 + c2_a2;

    int vencedoraFinal = (soma1 > soma2) ? 1 : (soma2 > soma1) ? 2 : 0; // ternário

    // ==========================
    // Exibir resultado claro
    // ==========================
    printf("\n==============================\n");
    printf("Comparacao entre: %s x %s\n", nome1, nome2);
    printf("Atributos escolhidos: (1) %s  e  (2) %s\n", nomeAttr1, nomeAttr2);
    printf("==============================\n\n");

    printf("[Atributo 1] %s\n", nomeAttr1);
    printf("%s: %.6f\n", nome1, c1_a1);
    printf("%s: %.6f\n", nome2, c2_a1);
    printf("Vencedor do atributo 1: %s\n\n",
           (win1 == 1) ? nome1 : (win1 == 2) ? nome2 : "Empate");

    printf("[Atributo 2] %s\n", nomeAttr2);
    printf("%s: %.6f\n", nome1, c1_a2);
    printf("%s: %.6f\n", nome2, c2_a2);
    printf("Vencedor do atributo 2: %s\n\n",
           (win2 == 1) ? nome1 : (win2 == 2) ? nome2 : "Empate");

    printf("---- Soma dos atributos ----\n");
    printf("%s: %.6f\n", nome1, soma1);
    printf("%s: %.6f\n", nome2, soma2);

    if (vencedoraFinal == 1) {
        printf("\nResultado final: %s venceu!\n", nome1);
    } else if (vencedoraFinal == 2) {
        printf("\nResultado final: %s venceu!\n", nome2);
    } else {
        printf("\nResultado final: Empate!\n");
    }

    return 0;
}
